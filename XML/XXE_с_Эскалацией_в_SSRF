Описание уязвимости
Приложение принимает XML-документы и обрабатывает их без ограничения на внешние сущности.
XML-парсер автоматически разрешает внешние сущности, что создаёт предпосылки для атаки XXE.

Тип уязвимости
 • XML External Entity (XXE)
 • Server-Side Request Forgery (SSRF)

Точка входа
POST /api/import
Content-Type: application/xml

Метод обнаружения
В XML-документ добавлена внешняя сущность, указывающая на внешний ресурс.
Сервер выполнил сетевой запрос, что подтвердило возможность SSRF.

Цепочка эксплуатации
 1. Внедрение внешней XML-сущности
 2. Разрешение сущности XML-парсером
 3. Выполнение сервером сетевого запроса

Потенциальное воздействие
 • Доступ к внутренним сервисам
 • Сканирование внутренней сети
 • Получение служебных данных (например, metadata cloud-сервисов)

Рекомендации по устранению
 • Отключить обработку внешних сущностей
 • Использовать безопасные XML-парсеры
 • Ограничить исходящие соединения сервера

Примечание
Уязвимость демонстрирует, как ошибка уровня парсинга может привести к компрометации инфраструктуры.
